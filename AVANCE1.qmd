---
title: "PRIMERA_ENTREGA"
format: html
editor: visual
---

# GRUPO 3:

### Integrantes :

-   Alania Huillca Miguel Edison

-   Tassara Acosta Rodrigo Andrés

-   Olagibel Romero Fabricio Alberto

-   Trinidad Leiva Isaac Eduardo

-   Huaman Puiquin Hector Emilio

## Objetivo General:

**Determinar si en su mayoría los alumnos de pregrado de la Universidad de Ingeniería y Tecnología consumen café.**

## Objetivos Específicos:

1.  **COMPARAR** el rendimiento académico entre los estudiantes de pregrado de la Universidad de -Tecnología e Ingeniería que consumen café y los que no consumen café.

2.  EXPLORAR la relación económica de los estudiantes de pregrado de la Universidad de Tecnología e Ingeniería con su comportamiento de consumo de café.

## Variables y sus tipos:

## Primer objetivo

-   Número de tazas de café que los estudiantes de UTEC consumen durante los días de exámenes.(**Cuantitativa discreta**) -\>

-   Número de horas extras que los estudiantes de UTEC dedican al estudio cuando consumen café.(**Cuantitativa continua**)

-   Impacto en el rendimiento académico de los estudiantes de UTEC al consumir café.(**Cualitativa ordinal**)

-   Café favorito de los estudiantes de UTEC en sus horas de estudio.(**Cualitativa nominal**)

## Segundo objetivo

-   Cantidad máxima de dinero que los estudiantes de UTEC pagarían por una taza de café.(**Cuantitativa continua**)

-   Gasto semanal de café de los estudiantes de UTEC .(**Cuantitativa discreta**)

-   Tipo de beca de los estudiantes de pregrado de UTEC.(**Cualitativa ordinal**)

-   Establecimiento favorito de los estudiantes de UTEC para comprar café.(**Cualitativa nominal**

# Análisis de la base de datos.

Para poder ejecutar el código y hacer el análisis de la base de datos, usaremos el lenguaje de Programación Estadístico R y ciertas librerías para facilitar el proceso.

Instalar las librerías:

```{r}
# install.packages("readr") # Para cargar el csv
# install.packages("plyr")
# install.packages("dplyr")
# install.packages("tidyr")
# install.packages("tidyverse") 
# install.packages("ggplot2") # Para imprimir los gráficos
```

Y las importamos de la siguiente manera.

```{r}
library(readr)
library(plyr)
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
```

### Miscelánea

```{r}
df <- read_csv("Café (respuestas).csv")
df_filtered <- df %>% filter(str_starts(as.character(`Alumno encuestador`), "3"))

df_filtered

print("Cantidad de encuestas por integrante: ")
custom_tags <- c("Hector", "Miguel", "Eduardo", "Rodrigo", "Fabricio")
tag_values <- table(df_filtered$`Alumno encuestador`)

for (i in seq_along(custom_tags)) {
  cat(custom_tags[i], ":", tag_values[i], "\n")
}
total_value <- sum(tag_values)
cat("Cantidad total de muestras :", total_value, "\n")
cantidad_muestras_sin_na <- nrow(df_no_na)

df_no_na <- na.omit(df_filtered)
cat("Cantidad de muestras sin NAs :", cantidad_muestras_sin_na, "\n")

print(df_no_na)
```

# Avance 2

En primer lugar, definimos las variables relevantes para nuestro caso\

### Variables Generales:

1.  **Sexo** (Sexo)

2.  **Edad** (Edad)

3.  **Ciclo** (Ciclo académico)

### Objetivo 1: Comparar el rendimiento académico entre quienes consumen café y quienes no

1.  **¿Consume café?**

2.  **¿Cuántas tazas de café consumes en un día?**

3.  **¿Cuántas tazas de café consumías antes de ser alumno de UTEC?**

4.  **Durante un día de exámenes, ¿Cuántas tazas de café consumes?**

5.  **¿Dedicas tiempo extra al estudio cuando consumes café? ¿Cuánto?**

6.  **Si tuvieras que describir tu rendimiento académico cuando consumes café ¿Cómo sería?**

7.  **¿Cuál fue tu promedio ponderado en el ciclo 2024-1?**

### Objetivo 2: Explorar la relación económica del consumo de café

1.  **¿Recibes algún apoyo económico para estudiar UTEC?**

2.  **¿Cuál es el monto máximo que estás dispuesto a gastar en una buena taza de café?**

3.  **¿Cuánto gastas en café a la semana?**

4.  **¿En qué tipo de establecimiento compras café con mayor frecuencia?**

5.  **¿Tu consumo de café cambió al ingresar a la universidad?**

ahora que ya hemos definido las variables relevantes, creamos un dataset de solo estas

```{r}
crear_DF2 <- function(df_filtered) {
  # Seleccionar las variables de interés
  DF2 <- df_filtered[, c("Sexo",
                         "Edad",
                         "Ciclo:",
                         "¿Consume café?",
                         "En promedio ¿Cuántas tazas de café consumes en un día?",
                         "Antes de ser alumno de UTEC, ¿cuántas tazas de café consumías al día aproximadamente?",
                         "Durante un día de exámenes, ¿Cuántas tazas de café consumes?",
                         "¿Dedicas tiempo extra al estudio cuando consumes café? ¿Cuánto?",
                         "Si tuvieras que describir tu rendimiento académico cuando consumes café ¿Cómo sería?",
                         "¿Cuál fue tu promedio ponderado en el ciclo 2024-1? (Tal cual aparece en tu intranet de estudiante).",
                         "¿Recibes algún apoyo económico para estudiar UTEC?",
                         "¿Cuál es el monto máximo que estás dispuesto a gastar en una buena taza de café? (en soles)",
                         "¿Cuánto gastas en café a la semana?",
                         "¿En qué tipo de establecimiento compras café con mayor frecuencia?",
                         "¿Tu consumo de café cambió al ingresar a la universidad?")]
  
  return(DF2)
}

# Uso de la función para crear el nuevo dataset DF2
DF2
```

ahora lo que haremos sera cambiarle el nombre a las variables para que el dataset sea mas fácil de entender

### Variables Generales:

1.  **Sexo** (Sexo)

2.  **Edad** (Edad)

3.  **Ciclo** (Ciclo académico)

### Objetivo 1: Comparar el rendimiento académico

1.  **Consumo_cafe** (¿Consume café?)

2.  **Tazas_por_dia** (En promedio, ¿Cuántas tazas de café consumes en un día?)

3.  **Tazas_antes_UTEC** (¿Cuántas tazas de café consumías antes de ser alumno de UTEC?)

4.  **Tazas_examenes** (Durante un día de exámenes, ¿Cuántas tazas de café consumes?)

5.  **Tiempo_extra_estudio** (¿Dedicas tiempo extra al estudio cuando consumes café?)

6.  **Rendimiento_con_cafe** (¿Cómo describirías tu rendimiento académico cuando consumes café?)

7.  **Promedio_ponderado_2024_1** (Promedio ponderado en el ciclo 2024-1)

### Objetivo 2: Relación económica del consumo de café

1.  **Apoyo_economico** (¿Recibes algún apoyo económico para estudiar en UTEC?)

2.  **Monto_maximo_cafe** (Monto máximo dispuesto a gastar en una buena taza de café)

3.  **Gasto_semanal_cafe** (Gasto en café a la semana)

4.  **Lugar_compra_cafe** (Tipo de establecimiento donde compras café con mayor frecuencia)

5.  **Cambio_consumo_UTEC** (¿Tu consumo de café cambió al ingresar a la universidad?)

creamos otra función para ejecutar estos cambios:

```{r}
cambiar_nombres_DF2 <- function(DF2) {
  # Cambiar los nombres de las columnas
  colnames(DF2) <- c("Sexo", 
                     "Edad", 
                     "Ciclo", 
                     "Consumo_cafe", 
                     "Tazas_por_dia", 
                     "Tazas_antes_UTEC", 
                     "Tazas_examenes", 
                     "Tiempo_extra_estudio", 
                     "Rendimiento_con_cafe", 
                     "Promedio_ponderado_2024_1", 
                     "Apoyo_economico", 
                     "Monto_maximo_cafe", 
                     "Gasto_semanal_cafe", 
                     "Lugar_compra_cafe", 
                     "Cambio_consumo_UTEC")
  
  return(DF2)
}

DF2
```

ahora vamos a ver si necesitamos limpiar alguna variable\
como vemos todas o han sido categórica ordinal o categórica nominal o numérica continua y de marcar\
sin embargo podemos ver que hay variables como promedio donde hay datos raros como un promedio 84 por ejemplo\
vamos a limpiar estos datos estableciendo que promedio no puede subir de 20 remplazándolos con NAs

```{r}
DF2$Promedio_ponderado_2024_1 <- ifelse(DF2$Promedio_ponderado_2024_1 > 20, NA, DF2$Promedio_ponderado_2024_1)


DF2
```

Como vemos la variable ahora esta limpia\
Ahora vamos a limpiar la variable ciclo, para asegurarnos que solo este en el rango normal que debería tener de 1 a 10

```{r}
reemplazar_ciclo_na <- function(DF2) {
  DF2$Ciclo <- ifelse(DF2$Ciclo < 1 | DF2$Ciclo > 10, NA, DF2$Ciclo)
  return(DF2)
}

DF2
```

Ahora trataremos de limpiar a la variable edad\
primero la analizaremos mediante quantile

```{r}
quantile(DF2$Edad,na.rm = TRUE)
max(DF2$Edad)
```

como vemos si presenta valores atípicos\
para esto limitamos el rango de edades a menos de 199 para ver si ese era el único valor raro, usando como criterio máximo 50

```{r}
DF2$Edad <- ifelse(DF2$Edad > 50, NA, DF2$Edad)

quantile(DF2$Edad, na.rm = TRUE)
```

Como vemos nos bota 39 que si tiene algo de sentido como edad máxima

seguimos con la variable tazas por día y usamos quantile para ver si hay datos anormales\
primero convertimos la variable a numérica y luego usamos quantile.

```{r}
DF2$Tazas_por_dia <- as.numeric(DF2$Tazas_por_dia)
quantile(DF2$Tazas_por_dia, na.rm = TRUE)
```

como vemos si hay un valor anormal el cual es el 80\
filtramos con el criterio que nos dijo el profesor el cual era de 10 tazas y comprobamos

```{r}
  
DF2$Tazas_por_dia <- ifelse(DF2$Tazas_por_dia > 10, NA, DF2$Tazas_por_dia)

quantile(DF2$Tazas_por_dia, na.rm = TRUE)
```

Nos quedamos con 10 tazas que si bien es algo extremo es mas creíble pues fue lo que nos dijo el profesor que se tomaba al día

ahora trataremos de limpiar la variable Tazas_antes_UTEC de la misma manera, primero la convertimos a numerica y como ya tenemos el criterio de las 10 tazas lo aplicamos directamente

```{r}
DF2$Tazas_antes_UTEC <- as.numeric(DF2$Tazas_antes_UTEC)
DF2$Tazas_antes_UTEC <- ifelse(DF2$Tazas_antes_UTEC > 10, NA, DF2$Tazas_antes_UTEC)

quantile(DF2$Tazas_antes_UTEC, na.rm = TRUE)
```

Nos queda con 6 tazas al día como máximo lo cual es creíble

ahora trataremos de limpiar la variable Tazas_exámenes, como ya tenemos criterio ponemos de frente el máximo 10 tazas

```{r}
DF2$Tazas_examenes <- ifelse(DF2$Tazas_examenes > 10, NA, DF2$Tazas_examenes)
quantile(DF2$Tazas_examenes, na.rm = TRUE)
```

nos queda como máximo el diez que como dijimos anteriormente si bien es extremo es creíble

ahora es el turno de la variable monto_máximo_café\
aplicamos criterio y usamos como filtro 50 soles máximo

```{r}
DF2$Monto_maximo_cafe <- ifelse(DF2$Monto_maximo_cafe > 50, NA, DF2$Monto_maximo_cafe)
quantile(DF2$Monto_maximo_cafe, na.rm = TRUE)
```

nos da 40 que si bien es extremo es creíble

ahora es el turno de la variable Gasto_semanal_cafe\
aplicamos criterio y usamos como filtro 100 soles máximo

```{r}
DF2$Gasto_semanal_cafe <- ifelse(DF2$Gasto_semanal_cafe > 100, NA, DF2$Gasto_semanal_cafe)
quantile(DF2$Gasto_semanal_cafe, na.rm = TRUE)
```

Nos da 100 soles que si bien es bastante es creíble

por ultimo vemos el dataframe ya limpio y prolijo

```{r}
DF2
```

calculamos el tamaño efectivo de cada variable y su cantidad de NAs y su porcentaje de NAs

```{r}

data.frame(
Tamaño_efectivo = sapply(DF2, function(columna) sum(!is.na(columna))),
NAs_totales = sapply(DF2, function(columna) sum(is.na(columna))),
Porcentaje_NA = round(sapply(DF2, function(columna) sum(is.na(columna)))
/270*100, 2))
```

# Avance 3

1.  Este avance parte la base de datos limpia. Es decir, la muestra efectiva.

2.  Partimos en dos bloques de análisis:\

    1.  Análisis univariado

    2.  Análisis bivariado

3.  También puede estructurarse el informe en función de los objetivos\

    **Objetivo 1**: Explorar la relación entre el consumo de café y el rendimiento académico en los estudiantes de pregrado de la Universidad de Ingeniería y Tecnología\

    **Objetivo 2**: Explorar la relación económica de los estudiantes de pre-grado de la Universidad de Tecnología e Ingeniería con su comportamiento de consumo de café.\

4.  Identificar las variables más relevantes del estudio.

Las variables mas relevantes para el estudio en este caso son\
para el **Objetivo 1**:\
Tazas_por_día y Rendimiento_con_cafe

Tazas_por_día =\> numerica continua =\> histograma\
Rendimiento_con_café =\>cualitativa ordinal =\> gráfico de barras

para el **Objetivo 2**:

Gasto_semanal_café y Apoyo_económico

Gasto_semanal_café =\> numerica continua =\> histograma

Apoyo_económico =\> cualitativa nominal =\> gráfico de barras

# Análisis Tazas_por_día:

```{r}

moda <- as.numeric(names(sort(table(DF2$Tazas_por_dia), decreasing = TRUE)[1]))
promedio <- mean(DF2$Tazas_por_dia, na.rm = TRUE)
mediana <- median(DF2$Tazas_por_dia, na.rm = TRUE)

grafico_cafe <- ggplot(DF2, aes(x = Tazas_por_dia)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "white", alpha = 0.7) +
  labs(title = "Consumo de café en alumnos UTEC en tazas diarias",
       x = "Cantidad de tazas",
       y = "Frecuencia dentro de la muestra") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 18),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    axis.text = element_text(size = 12)
  ) +
  scale_x_continuous(breaks = seq(0, max(DF2$Tazas_por_dia, na.rm = TRUE), by = 1)) +
  scale_y_continuous(expand = c(0, 0)) +
  geom_vline(aes(xintercept = moda), color = "red", linetype = "dashed", linewidth = 1) +   
  geom_vline(aes(xintercept = promedio), color = "green", linetype = "dashed", linewidth = 1) +  
  geom_vline(aes(xintercept = mediana), color = "blue", linetype = "dashed", linewidth = 1) +   
  geom_text(aes(x = moda, y = max(table(DF2$Tazas_por_dia)) + 1, label = "Moda"), color = "red", vjust = +7.5, size = 5) +
  geom_text(aes(x = promedio, y = max(table(DF2$Tazas_por_dia)) + 2, label = "Promedio"), color = "green", vjust = +13.5, size = 5) +
  geom_text(aes(x = mediana, y = max(table(DF2$Tazas_por_dia)) + 3, label = "Mediana"), color = "blue", vjust = +10.5, size = 5)

print(grafico_cafe)

quantile(DF2$Tazas_por_dia, na.rm = TRUE)
table(DF2$Tazas_por_dia)
sum(!is.na(DF2$Tazas_por_dia))
sum(is.na(DF2$Tazas_por_dia))
3/176*100
round(mean(DF2$Tazas_por_dia, na.rm = TRUE), 2)
round(sd(DF2$Tazas_por_dia, na.rm = TRUE)/mean(DF2$Tazas_por_dia, na.rm = TRUE)*100, 2)

```

**Análisis:**

se observa en el gráfico 1, que la frecuencia de las tazas es bastante asimétrica, siendo asimétrica hacia la derecha. En otras palabras, mas del 50% de la muestra tiene un consumo de café menor o igual a la mediana, la cual es de 2 tazas por día, estando la variable muy poco dispersa. El promedio es algo mas alto que la mediana, siendo 2.16 tazas por alumno, debido a la presencia de personas que dijeron consumir 9 o mas tazas diarias (1.7%). A pesar de esto, el promedio no es significativamente mas grande que la mediana. Sin embargo, el CV es bastante grande (76.83%), por lo que el mejor descriptor para resumir el consumo de café sigue siendo la mediana. La moda se aleja significativamente de los otros dos descriptores, siendo de 1. En conclusión, podemos afirmar que la gran mayoría de alumnos que consumen café en UTEC suelen no consumir mas de 2 tazas, con lo mas común siendo que consuman solo 1, por lo que suele ser un consumo de café generalmente bajo y casual.

# Análisis Rendimiento_con_café

```{r}
grafico_rendimiento_cafe <- ggplot(DF2, aes(x = Rendimiento_con_cafe)) +
  geom_bar(fill = "steelblue", color = "white", alpha = 0.7) +
  labs(title = "Rendimiento Académico de Alumnos de UTEC con Café",
       x = "Calidad de rendimiento con Café",
       y = "Frecuencia") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 18),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    axis.text = element_text(size = 12)
  ) +
  scale_x_discrete(drop = FALSE) +  
  scale_y_continuous(expand = c(0, 0)) + 
  geom_text(stat = 'count', aes(label = ..count..), vjust = +1, size = 5)  

print(grafico_rendimiento_cafe)

round(97/178*100, 2)
round(54/178*100, 2)
round(20/178*100, 2)
round(7/178*100, 2)
```

**Análisis:**

En el gráfico que representa el **rendimiento académico** de los alumnos de UTEC que consumen café, se observa una distribución clara y diferenciada de las categorías, ordenadas de mejor a menor rendimiento: "**excelente" (20), "bueno" (97), "regular" (54) y "puede mejorar" (7)**. Esta distribución muestra que la mayoría de los estudiantes perciben un rendimiento "**bueno"** al consumir café, siendo el **54.49%** del total. "**Regular"** ocupa el segundo lugar, siendo el **30.34%** del total, seguido por "**Excelente**" (**11.24%**) y **"Puede mejorar"** (**3.94%**). Tanto la **moda** como la **mediana** la pertenecen a "**bueno**", por lo que se puede decir en relación a la anterior esta variable es mucho mas simétrica y concentrada en la **mediana**. En base a esta información, podemos concluir que el consumo de café se asocia predominantemente con un rendimiento académico bueno entre los estudiantes de UTEC, con una significativa cantidad que considera su rendimiento como excelente gracias al consumo de esta bebida.

# Análisis de correlación de las dos variables

Una vez ya analizadas las dos variables, es hora de ver si existe algún tipo de correlación entre ellas. Como sabemos, el objetivo 1 trata básicamente acerca de si hay una correlación entre cuanto café consume un alumno y su rendimiento, pues esta fue una conjetura establecida por el profesor Orlando Galarza, el cual afirmo que mientras mas café consuma un estudiante mejor le va ir. La manera de tratar de comprobar esta hipótesis es mediante las dos variables que hemos escogido, pues una nos indica cuanto café consumen los alumnos y la otra nos indica que tan bien les va. La manera en la que intentaremos encortar la correlación sera de la siguiente manera: Filtraremos a los alumnos que dicen consumir solo entre 1 y 2 tasas y volveremos a generar un gráfico de la variable rendimiento, el cual sera exclusivo de este grupo. Luego haremos otro gráfico de la variable rendimiento pero solo con los alumnos que tomen 3 o mas tazas al día. La lógica nos dice que este ultimo grupo debería tener mayor cantidad de rendimientos tipo "excelente" y "bueno" que el inicial, el cual debería tener mas rendimientos de tipo "regular" y "puede mejorar" proporcionalmente.\

**GRAFICO 1: GRUPO 1 y 2 Tazas al Día**

```{r}
grafico_rendimiento_cafe <- DF2 %>%
  filter(Tazas_por_dia >= 1 & Tazas_por_dia <= 2) %>%
  ggplot(aes(x = Rendimiento_con_cafe)) +
  geom_bar(fill = "steelblue", color = "white", alpha = 0.7) +
  labs(title = "Rendimiento de alumnos que consumen de 1 a 2 tazas",
       x = "Calidad de rendimiento con Café",
       y = "Frecuencia") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 18),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    axis.text = element_text(size = 12)
  ) +
  scale_x_discrete(drop = FALSE) +  
  scale_y_continuous(expand = c(0, 0)) + 
  geom_text(stat = 'count', aes(label = ..count..), vjust = +1, size = 5)  

print(grafico_rendimiento_cafe)

round(71/122*100, 2)
round(7/122*100, 2)
round(41/122*100, 2)
```

**GRAFICO 2: GRUPO 3 y mas Tazas al Día\
**

```{r}


grafico_rendimiento_cafe <- DF2 %>%
  filter(Tazas_por_dia >= 3) %>%  # Filtra para tazas por día de 3 en adelante
  ggplot(aes(x = Rendimiento_con_cafe)) +
  geom_bar(fill = "steelblue", color = "white", alpha = 0.7) +
  labs(title = "Rendimiento de alumnos que consumen 3 o mas tazas",
       x = "Calidad de rendimiento con Café",
       y = "Frecuencia") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 18),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    axis.text = element_text(size = 12)
  ) +
  scale_x_discrete(drop = FALSE) +  
  scale_y_continuous(expand = c(0, 0)) + 
  geom_text(stat = 'count', aes(label = ..count..), vjust = +1, size = 5)  

print(grafico_rendimiento_cafe)


round(24/47*100, 2)
round(10/47*100, 2)
round(9/47*100, 2)
```

**Análisis:**

Como podemos ver, el gráfico 1 (grupo de entre 1 y 2 tazas) y el gráfico 2 (grupo de entre 3 o mas tazas) son significativamente diferentes. Si bien la **moda** en ambos es rendimiento tipo "bueno" (58.2% en gráfico 1, 51.06% en el gráfico 2), el porcentaje de alumnos con rendimiento "excelente" es muchísimo mas alto en el gráfico 2, siendo el 21.28%, mientras que el porcentaje de alumnos con rendimiento "excelente" en el gráfico 1 es apenas del 5.74%. En otras palabras, los alumnos que toman 3 o mas tazas de café al día tienen en proporción al tamaño de su grupo unas 4 veces mas personas con rendimiento excelente comparado a los alumnos que solo toman de 1 a 2 tazas de café al día. En cuanto al porcentaje de alumnos con rendimiento "regular", este es significativamente mas bajo en el gráfico 2, siendo solo el 19.15%, mientras que en el gráfico 1 es del 33.61%. En base a esto, podemos concluir que la hipótesis fue cierta, ya que hay una cierta correlación directamente proporcional entre mientras mas café tome un alumno y su rendimiento académico.

# OBJETIVO 2:

# Análisis Gasto_semanal_café

```{r}
moda <- as.numeric(names(sort(table(DF2$Gasto_semanal_cafe), decreasing = TRUE)[1]))
promedio <- mean(DF2$Gasto_semanal_cafe, na.rm = TRUE)
mediana <- median(DF2$Gasto_semanal_cafe, na.rm = TRUE)

# Crear el gráfico para Gasto_semanal_cafe con breaks de 20 unidades
grafico_cafe <- ggplot(DF2, aes(x = Gasto_semanal_cafe)) +
  geom_histogram(binwidth = 20, fill = "steelblue", color = "white", alpha = 0.7) +  # Binwidth ajustado a 20
  labs(title = "Gasto semanal en café de alumnos UTEC",
       x = "Gasto semanal en soles",
       y = "Frecuencia dentro de la muestra") +
  theme_minimal(base_size = 15) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 18),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    axis.text = element_text(size = 12)
  ) +
  scale_x_continuous(breaks = seq(0, max(DF2$Gasto_semanal_cafe, na.rm = TRUE), by = 20)) +  # Breaks cada 20 unidades
  scale_y_continuous(expand = c(0, 0)) +
  geom_vline(aes(xintercept = moda), color = "red", linetype = "dashed", size = 1) +   
  geom_vline(aes(xintercept = promedio), color = "green", linetype = "dashed", size = 1) +  
  geom_vline(aes(xintercept = mediana), color = "blue", linetype = "dashed", size = 1) +   
  geom_text(aes(x = moda, y = max(table(DF2$Gasto_semanal_cafe)) + 1, label = "Moda"), color = "red", vjust = -2.5, size = 5) +
  geom_text(aes(x = promedio, y = max(table(DF2$Gasto_semanal_cafe)) + 2, label = "Promedio"), color = "green", vjust = -4.5, size = 5) +
  geom_text(aes(x = mediana, y = max(table(DF2$Gasto_semanal_cafe)) + 3, label = "Mediana"), color = "blue", vjust = +0.5, size = 5)

# Mostrar el gráfico
print(grafico_cafe)

print(promedio)
print(mediana)
print(moda)

round(sd(DF2$Gasto_semanal_cafe, na.rm = TRUE)/mean(DF2$Gasto_semanal_cafe, na.rm = TRUE)*100)
```

Análisis:
